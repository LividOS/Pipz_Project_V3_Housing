; ------------------------------------------------------------------
; GEMINI MEM TAG (DO NOT EVER REMOVE OR EDIT) - MY FULL PATH IS "Pipz_Project_V3\PROJECT_WORKING_NOTES.txt"
; ------------------------------------------------------------------

; ------------------------------------------------------------------
; MAINTEMPLATE - PROJECT_WORKING_NOTES.txt
; Version: 0.1.3
; Last change: Added extension repackaging design rationale.
; Content-Fingerprint: 2026-01-24T14-15-57Z-XG7W1RRD
; ------------------------------------------------------------------

; ------------------------------------------------------------------
; ALL CONTENT MUST GO BELOW THIS POINT (LINES 1-14 RESERVED)
; ------------------------------------------------------------------

PURPOSE OF THIS FILE
--------------------
This document exists to preserve:
- Design intent
- Non-obvious decisions
- Sanity checks
- “Why we did it this way”
- Guardrails against future regression

This file is NOT a checklist.
This file is NOT expected to be concise.
This file SHOULD grow over time.

; ------------------------------------------------------------------
CORE GOALS (DO NOT LOSE SIGHT OF THESE)
; ------------------------------------------------------------------

1. The user interacts with ONE assistant only (Architect).
2. All other AI roles are hidden, automated, and auditable.
3. Governance is enforced by code, not “AI good behavior.”
4. Drift is mechanically impossible, not just unlikely.
5. Every change is attributable, reviewable, and reversible.

If any future change weakens these goals, STOP.

; ------------------------------------------------------------------
WHY SIDECAR GOVERNANCE EXISTS
; ------------------------------------------------------------------

Some file formats are controlled by external tools:
- JSON
- lockfiles
- generated artifacts
- binaries

Governance MUST NEVER break tooling.

Therefore:
- Governance metadata moves to sidecar files
- Sidecars are authoritative
- Runtime artifacts remain pure

This is not a compromise — it is intentional architecture.

; ------------------------------------------------------------------
WHY NOT RELY ON CONTINUE / BUILT-IN AGENTS ALONE
; ------------------------------------------------------------------

Continue is powerful, but:
- It does not natively enforce hidden multi-model chaining
- It cannot prevent a model from “doing too much”
- It cannot hard-enforce mirroring or fingerprint rules

Therefore:
- Continue is treated as the Architect UI only
- Enforcement lives outside the model
- MCP / orchestrator handles invariants

; ------------------------------------------------------------------
ROLE SEPARATION INTENT
; ------------------------------------------------------------------

Architect:
- Thinks
- Plans
- Explains
- Is the ONLY user-facing AI
- NEVER writes directly

Executor:
- Implements literally
- No opinions
- No creativity
- Outputs full files by default

SubSupervisor:
- Mechanical checklist
- Objective PASS / FAIL
- Cannot be overridden

HeadSupervisor:
- Semantic correctness
- Architectural intent validation
- Risk detection
- Cannot override mechanical failure

; ------------------------------------------------------------------
RECENT KEY DECISIONS (IMPORTANT CONTEXT)
; ------------------------------------------------------------------

[2026-01-22]
- MVP orchestrator introduced with bootstrap-only behavior.
- No model calls, no file writes — audit-only.
- Establishes a safe, runnable baseline before hidden chaining is enabled.

[2026-01-22]
- JSON governance finalized via mandatory sidecar files:
  - package.json.governance.txt
  - tsconfig.json.governance.txt
- JSON remains pure and non-fingerprinted by embedded headers.

[2026-01-23]
- Completed port of MirrorAhkToTxt functionality into a VS Code extension:
  - Fingerprint updates on save (governed files, fail-closed gating)
  - Runtime mirroring (.ahk/.ini -> .txt) with AI SOT header
  - Standalone governed fingerprinting for additional file types
  - UTF-8 + UTF-16 mirror encoding compatibility
  - Audit logging into .ORCH_AUDITLOG\mirror\
- Extension packaged (VSIX) and installed into normal VS Code.
- Verified in normal VS Code (no Extension Development Host required for mirroring/fingerprints).

[2026-01-23]
- Noted VS Code Extension Development Host anomaly:
  - Dev Host could open files but refused to open folders/workspaces.
  - Debug console showed DisposableStore disposed warnings.
  - Gemini assisted in resolving the folder-open issue so development can continue.

; ------------------------------------------------------------------
COMMON FAILURE MODES TO WATCH FOR
; ------------------------------------------------------------------

- “We’ll remember to do X later” → NO
- “This file doesn’t need governance” → PROVE IT
- “The AI probably won’t touch that” → INVALID ASSUMPTION
- Silent tool behavior changes (VS Code / extensions)
- Header drift across file types
- JSON accidentally acquiring comments (must remain pure)

; ------------------------------------------------------------------
WHEN TO STOP AND REASSESS
; ------------------------------------------------------------------

STOP if:
- A tool change removes determinism
- A file bypasses governance
- A human must remember a rule instead of tooling enforcing it
- The user must manually switch AI roles for normal operation (end goal is hidden chaining)
- Audit logs become incomplete or optional

; ------------------------------------------------------------------
VS CODE EXTENSION REPACKAGING – DESIGN RATIONALE
; ------------------------------------------------------------------

The pipz-mirror-governance extension is not “just a tool”.
It is an ACTIVE GOVERNANCE ENFORCER.

Therefore:

- Any change to it can silently weaken guarantees if not rebuilt correctly
- VS Code does NOT auto-reload packaged extensions
- Extension Development Host ≠ real user environment

Because of this, a strict VSIX repackaging runbook was introduced.

Key principles enforced by the runbook:

1. BUILD IS EXPLICIT
   No implicit TypeScript transpilation is trusted.

2. INSTALL IS EXPLICIT
   The extension must be installed into the NORMAL VS Code instance,
   not assumed to be active because Dev Host worked.

3. VERIFICATION IS MANDATORY
   Mirroring, fingerprinting, encoding, and audit logging must be
   observed in real saves.

4. NO SILENT FAILURE
   If the extension fails to activate or log, work stops immediately.

This mirrors the broader project philosophy:

- Trust code, not memory
- Trust logs, not assumptions
- Trust enforcement, not intent

This runbook is deliberately repetitive and procedural.
That is a feature, not a flaw.

; ------------------------------------------------------------------
FUTURE NOTES
; ------------------------------------------------------------------

(Add dated notes below as decisions are made.)

[YYYY-MM-DD] —
- Decision:
- Reason:
- Impact:
